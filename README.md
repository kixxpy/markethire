# Markethire

–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è —Å–≤—è–∑–∏ —Å–µ–ª–ª–µ—Ä–æ–≤ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–æ–≤ (Wildberries, OZON) —Å –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è–º–∏ —É—Å–ª—É–≥.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Node.js 18+ 
- PostgreSQL
- npm –∏–ª–∏ yarn

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
   ```bash
   npm install
   ```

3. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `.env.example`:
   ```bash
   cp .env.example .env
   ```

4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ `.env`:
   - `DATABASE_URL` - URL –≤–∞—à–µ–π PostgreSQL –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
   - `JWT_SECRET` - —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –¥–ª—è JWT —Ç–æ–∫–µ–Ω–æ–≤ (–º–∏–Ω–∏–º—É–º 32 —Å–∏–º–≤–æ–ª–∞)
   - `JWT_REFRESH_SECRET` - —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –¥–ª—è refresh —Ç–æ–∫–µ–Ω–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
   - `NODE_ENV` - –æ–∫—Ä—É–∂–µ–Ω–∏–µ (development, production, test)
   
   –î–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–µ–∫—Ä–µ—Ç–Ω—ã—Ö –∫–ª—é—á–µ–π –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:
   ```bash
   openssl rand -base64 32
   ```

5. –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:
   ```bash
   npm run db:migrate
   ```

6. –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ Prisma Client:
   ```bash
   npm run db:generate
   ```

7. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∏–¥–∏–Ω–≥ (–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏ —Ç–µ–≥–æ–≤):
   ```bash
   npm run db:seed
   ```

8. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
   ```bash
   npm run dev
   ```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É [http://localhost:3000](http://localhost:3000)

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
/prisma          - Prisma —Å—Ö–µ–º–∞ –∏ –º–∏–≥—Ä–∞—Ü–∏–∏
/src
  /api           - API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
  /lib           - –£—Ç–∏–ª–∏—Ç—ã –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
  /types         - TypeScript —Ç–∏–ø—ã
  /middleware    - Middleware —Ñ—É–Ω–∫—Ü–∏–∏
  /services      - –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
  /seed          - –°–∏–¥–∏–Ω–≥ –¥–∞–Ω–Ω—ã—Ö
/public          - –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
/pages           - Next.js —Å—Ç—Ä–∞–Ω–∏—Ü—ã
/tests           - –¢–µ—Å—Ç—ã
```

## üõ†Ô∏è –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

- `npm run dev` - –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- `npm run build` - –°–±–æ—Ä–∫–∞ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
- `npm run start` - –ó–∞–ø—É—Å–∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω —Å–µ—Ä–≤–µ—Ä–∞
- `npm run lint` - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞ –ª–∏–Ω—Ç–µ—Ä–æ–º
- `npm run db:generate` - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Prisma Client
- `npm run db:migrate` - –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π
- `npm run db:studio` - –û—Ç–∫—Ä—ã—Ç–∏–µ Prisma Studio
- `npm run db:seed` - –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –Ω–∞—á–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

## üìö –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Next.js** - React —Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- **TypeScript** - –¢–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JavaScript
- **Prisma** - ORM –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
- **PostgreSQL** - –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **JWT** - –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π refresh —Ç–æ–∫–µ–Ω–æ–≤
- **Zod** - –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- **Pino** - –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- **Rate Limiting** - –ó–∞—â–∏—Ç–∞ –æ—Ç DDoS –∏ –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

–ü—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –º–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:

- ‚úÖ Rate limiting –¥–ª—è API endpoints
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ —Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–∞
- ‚úÖ CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- ‚úÖ –ó–∞–≥–æ–ª–æ–≤–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (CSP, HSTS, X-XSS-Protection)
- ‚úÖ JWT —Ç–æ–∫–µ–Ω—ã —Å –∫–æ—Ä–æ—Ç–∫–∏–º –≤—Ä–µ–º–µ–Ω–µ–º –∂–∏–∑–Ω–∏ (15 –º–∏–Ω—É—Ç)
- ‚úÖ Refresh —Ç–æ–∫–µ–Ω—ã –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–µ—Å—Å–∏–∏
- ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ Health check endpoint –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

## üîê API –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

#### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
```http
POST /api/auth/register
Content-Type: application/json

{
  "email": "user@example.com",
  "password": "password123",
  "name": "–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
  "role": "SELLER" // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: SELLER, PERFORMER, BOTH (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
}
```

#### –í—Ö–æ–¥
```http
POST /api/auth/login
Content-Type: application/json

{
  "email": "user@example.com",
  "password": "password123"
}
```

–û—Ç–≤–µ—Ç:
```json
{
  "message": "–£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥",
  "user": { ... },
  "token": "access_token_here",
  "refreshToken": "refresh_token_here"
}
```

#### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
```http
POST /api/auth/refresh
Content-Type: application/json

{
  "refreshToken": "refresh_token_here"
}
```

#### Health Check
```http
GET /api/health
```

–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

### –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

#### –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
```http
GET /api/users/me
Authorization: Bearer <token>
```

#### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
```http
PATCH /api/users/me
Authorization: Bearer <token>
Content-Type: application/json

{
  "name": "–ù–æ–≤–æ–µ –∏–º—è",
  "description": "–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è",
  "priceFrom": 1000,
  "telegram": "@username",
  "whatsapp": "+79991234567",
  "emailContact": "contact@example.com",
  "role": "BOTH"
}
```

### –†–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

- **SELLER** - –°–µ–ª–ª–µ—Ä (–º–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –∑–∞–¥–∞—á–∏)
- **PERFORMER** - –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å (–º–æ–∂–µ—Ç –æ—Ç–∫–ª–∏–∫–∞—Ç—å—Å—è –Ω–∞ –∑–∞–¥–∞—á–∏)
- **BOTH** - –û–±–∞ (–º–æ–∂–µ—Ç –∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å –∑–∞–¥–∞—á–∏, –∏ –æ—Ç–∫–ª–∏–∫–∞—Ç—å—Å—è)

## üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

–ü–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ [DEPLOYMENT.md](./DEPLOYMENT.md).

–û—Å–Ω–æ–≤–Ω—ã–µ —à–∞–≥–∏:
1. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –∏ –ø—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏
3. –°–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: `npm run build`
4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å –ø–æ–º–æ—â—å—é PM2 –∏–ª–∏ systemd
5. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Nginx –∫–∞–∫ reverse proxy
6. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã (Let's Encrypt)

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

- Health check endpoint: `/api/health`
- –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏ —á–µ—Ä–µ–∑ Pino
- Rate limiting —Å –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ `X-RateLimit-*`

## üîß –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

```env
NODE_ENV=production
CORS_ORIGIN=https://yourdomain.com
LOG_LEVEL=info
MAX_REQUEST_SIZE=1mb
```

### Rate Limiting

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –ª–∏–º–∏—Ç—ã:
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è: 5 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ 15 –º–∏–Ω—É—Ç
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è: 3 –∑–∞–ø—Ä–æ—Å–∞ –≤ —á–∞—Å
- API: 100 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É
- –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á: 10 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

ISC
